## Trechos de Código para testes e depuração

## (Usar o índice lateral para navegar nos tópicos)
### 

&nbsp; 1) [Batimento NFP](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/325/Batimento-NFP)
 
&nbsp; 2) [Acompanhamento NFC-e](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/326/Acompanhamento-NFC-e)
 
&nbsp; 3) [Acompanhamento EPEC](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/327/Acompanhamento-EPEC)
 
&nbsp; 4) [Acompanhamento DW](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/328/Acompanhamento-DW)
 
&nbsp; 5) [Acerto de dados e troca de sinônimos na virada do ano](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/329/Acerto-de-dados-e-troca-de-sin%C3%B4nimos-na-virada-do-ano)
 
&nbsp; 6) [Outras Consultas SQL​](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/330/Outras-Consultas-SQL)
 
&nbsp; 7) [Snippets do Visual Studio](https://ads.intra.fazenda.sp.gov.br/tfs/ADMIN/Wiki_Arquitetura/_wiki/wikis/Wiki_Arquitetura.wiki/332/Snippets-do-Visual-Studio)

&nbsp; **8) descompactação de XML do Banco de Dados:**
&nbsp; Exemplo:
  
```
string hex = "1F8B08000000000004009D5959B3A2CA96FE2B46DD887EF1D6360145A9B68C4E46510619155F3A101051061514E5D77732B8873A754E9F732BF68E5CF965E69A73B172D73448EF91C207BD4712A7F9CF6F87A238FF180CCAB27C3B67D7C28DF751EEB9F15B94EEDF76D741BA0FBEB55B7FA439FE657B49BC65D77080030006801AA04D7E1E85FFFAD6BB07D7DCCD7E7E23DE30F06D368D7C292B82194500301D74936994FA46947AB31AEAC829D26AD6432BFB5A3DD1FFF90D8DC4081B822100244E50F508B031418ED000BA7F1886E1C470448E27D4AF927B88998F58A2D1B3F819319A0EEAB1992BFCEC750EA14A8BA66EA19E677690FA6EEF7CCDFC9BE7663D3FEB0579E1EE8238F0A224488B6C3A6837D64790F22B37ECCCA8A91A4C327F462269F558CFF3E01A05336C3A68894654AD0062D449F60F5C12CD70800DBF03F4333131EC073EFA3124BF03E247EDB77643BDB538B7479BB151C167918235D4518D81F22DE50564F30810A036B19DB70CC4E43C1BD51C6AA28510F7BCE5DA500D0BD69E51E8241ADA3D30D9CDF07A4B4DD4D03E4AEB98A1631DD579848F52376E147AD12F575D83BCC31BB28691A3BDDA3664E48BAC6114CA159ACED82C6333EF7FB137B4FEC27AFF1516FF5D9B5B4B9C0649D4DACC28ABC5EC6BAA4C070D58AF3E942C096670B592B81EA3CA2BCBE4F41EAD4343947A92C9C2E9A0DD51EF4519105CB98E2F3A2A85D7997E737B52909DB318650493DD0A941A414F7643373EB841DE5B5C11877A637324BD66B3711DB89A689930E778061516EABD712FE84D7A5E961E7B63ECDF63FCDF13AC46906F9B4DED76DA8DAEE8AC58B851D2A3A35D84563BACF78AF0D7F876076BCA806A6F052D494587DE5750EE1BABE9A0BD02C85DDC6A0686A3617D81919FD0ACE5BB72EB5400A39A6B43B76C1BB2F51762FAB1B0CF52940258A348C3A9017A5D8CBE78722A7268E790041881E388980E10D0E0F20C27480C1038128A268D7ABA39ABE3878617AF96CDD47F2539B342B71A59309C0C271340A2CD2BFE53AC15FE3BD7E364D1145988C61E946991534CAEC772BDB92AAB922A400639EA7BCF40AB369454BDC78B0603A53FE4C2EB5EBD72C1823D19EA1C3387528F86AC2A48A2FA6BF8B1D1E7E877A1B345091DB50C43954445FC7D488793F19F8494E67405EAACDA433F0C9457FF6F7829124517FFFBE1BDBA7914FF31BC931181111836C6C6BF0BEF7BD141D75AE49A19D5DCF16ED2783171A378561C2237CCDEF2EC56B9FFB38F6F8FEF51F1E66509FAD2D4E1ADB7748CBB184FDD5BB191A5BF8876BBFD7D1B4A8EA2978A4590FCFC867D7B1518FF657B4D02E20D3965589BFFB1C241653644DF10125013AA7619E2DF809D77EA9D12B4614F522D061A3D49D47ACE8AEB299C65EA6A8F47F782517BF87083BE4D727341DE792B8C8CF406787BCFEA591B1F5E5DCD461840B7BE211BF0C664C98CD94C070DD140979A4235F3F28EDCADB4A6C9F1907C235144BA79BBD6C8FD58FA6AA2798D76BF35B359683568C846850FF0D290B5121F1892DA4C3EABF1B18AA26F664557EB6BAAF363E0A37B418C0700AB7D14F8EF99F48AD2344ACE595E7437E28E8EB6B28704D14A7921CDBAC8C84643B52400EDA437CDAE51587FE39AB1C318C39C35A50E8D1D84BED03453979996E8D03B223FCCFAC0CF8D380C7FABB99C3F64A313CD6402A837B2FE4EBD2FB5B67DA8F6316FF55F892FF51105E3E8F24557EC8BAE7FAA55CD047BAB1B8EF33BBF3A136A18C3DE08BCCE03F1B3429F84BD035D56AABCA8BC746A27FFA95A1DAB71E392F367C6E850371D21678E91E2F74FCBAD465F657FC6DE53E63D535E25A3A9184556740D47EDE6F7D4FBAD9A7F1AB7760155AF2C9DBD16DAD98B59ED888651E789E9BD43DEE77F7A13EFFC35403D3068D2A89B742C82F005D7640B22B9DE0B6DE84E41F10522AA835662ABEDEA85FC3607FED2FBD3BB7A2BD007A9E3DD4EDA05D46F7E98A3F07FE3867EA47B138776FA0AD0B4B8BA697E7E75CCAD1FA8E62A763EE9F6BFB64DCF5D7F5D342D77DDADBE3AEE7B4D7CF2750D7775A5D951BF2AA01F79DD676A5FB75962BACFAE89EB65A87973D15A94A5E8AB5717AC66F99564DDC1F759FB4A418FA11F4614A287C0EDDA74A12F20F06BBE6D8F8F20C64DB334420FAAA8720B24410E8A43E6F7601CA2CA541C92DFBDA84CBD7E546103D45F7C47AFAAEF1E364CBFD70820B0D1B7DEE09DF9BB027F87EBAFEF34F452FA9E1F5CEC33433DD807D720F5829EA58B3FBFFDEB9F3EC0BAE6077132EBA0D5FECDBB5AF205FC679AA2176B1067E7C0FF9EBF0CEE94FE677CFF8E5FDB30FFC68246101B85A82FF94FBCFDC9D39F59D96E7C0B66EAF2615757B03F87737134B0FB7B412B9ED71D252CCB9FAD329F777F56F23D60B34FE09734FC9A282D87FDF30CE56BBF0855D5CEEE85C82BBBA169708B98BBDD9F8B646C70673ED92E77E3FD199F6F06B6E29EEF373C25B3D561412564248E641B6AAB6AB952E3CD8651EFBA519E2ED873981C616C1C49612D18B701279C780BE23915EC4FC7B1C413605E0D6C7DE8DBF46211CE9F13CB584D8ADB733019AF5732EB49A4CC52E21618897CBF28CEFDBE3E7AF3424F0EE0E4DA9E67A4932708436BCB3CC8C0EA3F4657F23C74F4BBC0A732BB25AA48AB4EDE447EE2134B3C9FB9BEE51BB63ABA038659DC94C1ED785D561C753C15C7ED531DF54B70C0811D3A93B161AC976BB500C67348DA99040ED6F132A709EC765F4A329D7B4BBE821345E138AD4AE67D2CBE8389B03F8D1C67A9BB27D31E1ABC57853ECF973F7F7EB8FF93B3BB102C83E797C2801A458A750BF723236A8409AE45B447F502953F5914E7E49161687F19C252A461286A36909E7D7F3D1046EBCB646F4BAC4F245C05153A3C5D0EA748A04A40432DE721CBD061C549323C0910B338FA20335A2C3ED05E9D0E159B8699C99C62D66230C64BF8CA5D970F83A585762D375798B2304FCACA8A3013F5BB758A9C77897E76701EEC9EF46947C8A186534F2FB1C18E58C41EC2B6066D6ED73EE62554250AA3BBC8D9952FF0A75DB766B19C2DD372A30F7CC8B266C9A1056255039421725E25D3C30D6B7295CC864F998565F3CB67350610F6504DB152CC138672B60C3DEDC15470D1EAEB98F0B430645D2E39CD616D4D5BF2F0BCD0305868E9E2E0E1712E1B562996CD9AC4D30FDADFE8F12E6DECA9F52B7784186AB6181A385FB8EB51E5E27C25EB792968AF330BDA236A1FF0C0DF2C0E22AF9F3D61126A26F7E04D68767E4326C69CC880503191EED5E9815E9B4799E15E36BB9A4DA32356886C562CDEB67424538B1734F2832C720F4BE7B8077AAD069FE3C968DC9ADB2C3027E1F39D40416783F415AC9B835305CA115A3CFE1A7F8E875065A03681F53A132E11CDC1D4A9483A2F16CFE7D69503C0AC04361FA7CE96E4C5FD53D0FAF27E31F188636A2F2394642BDD94FCB931A0FA94ECECAEC920188C63DBA6133266D7D42E16D6EC025B01E270368E84BDDC30CCE96AE2F26A225D1EC4E1822ED893030F93CD0D198C8F6E7FDE5FA7E63E101FE749BEA03791C40C37A4BB55AF6B7C4809E92DDF13D43A910277B23FDEB8F0B4F68ED8891B8FA4746817E7C30A5EE79AB2D5741E008308B3ADB15AEECC4D69DE0C855FD9A18863E38250B654F28CB347B5D392305956CBD19325E7DA937FE0178C586671BCC9D6E9C61A1BF2BCF299E33D269E1B08AA1BF0A33DAA8A7B5B1F9BCAA8BCE4E2853B6907CFDB01FBB9E115736E556308EC92C1E4FB32534FDC08E412EF69258A9606E96C28B2BCC930F0C195A16BD5F1F639CDA05393A1930B1CD2A11D9A9063E925442D2378AA261CCAE6899059B1924D19FD8A0F9575AAF7BCFFD35F26E44B8777B89286E53264434DB6635B12799AB7F9C5CA46773AA34F02BDA665A8C98846428FB0548E628564828687E95519EDBDF6CC3338E4D85FE5889CEEA576E4AC1FF90ED0076F4EE75B6374DCE1A064EA3BA1039386620959B8AF737F6EC89CC0C275486B0F8F2B4B66A43D46F8DDA82EA1501AE46E20F4175505D566AF36A1E17EC2D15066E800961E6CF885B4702AB7151DD3E1B6F6150375B15C57F4960EC32B1D723CAD7908DB2AEE5C071E9BDD253C3E7A0C1675F5EBE6AC1534221D09B1B91B52B2784A756D12A8CADDE8772F89D119BD749E14AD6194695823D6C4C4BBCED3EC06F0ECE6BDE68DCAADE09461C8318DBEFA840BF7A8E6ECBDD272E955C6E182811F803F87A4F4A4CE0E010BA7AB3352A2C41EAA2B884E7751E3AF9B938A48B68D6A8C72F605EAE9AE27F79DA03C2524F355FFF44ABE9B020FB61B0568D842467C9E3B96D6328E0C4D71BBFC339B77840D109D3B7F69F3E3E845B5CD9D7D27AF92C0E3E00BA83E738A6132A3A39794A5B5A4D58C7B0A46F26EDB73BBA1EFC896BAC69F77CF11B2957E97BDC529BC91D7F267B79B057037CA798B0FEF9AA574FE5DCCE527AA20A8DE7A84CE5A2714276291CB3468EEC842D3D632AD090C930B50B378BA4439F1116F9646DFB153E988CBD2A169CD9AA33AC6850E8A8D2397F6275C86CBBF88097F4463ED9F27F2EB7D678C50B3FFAB6DD4B1D17FBD6DBF09845CDBB07FC5670390CF52483815CC3EE95742C7F13E62431D3D022239F6D31762E423FFF62EEF0F353A6F6B74C8C150C90D47BD6DDD5D10949EC08FDC47FF78DC5BC3BD70DD04947B5A07D855E28F27BDEA978CE28C1337BF4561B1E625B68291A4AC657C79739E7AFA24C5934F72B70C2C1FCA459B97B88E42BBBE19CE08DFC9D67D72634FB29E8143268C37EA44580994556CABA76489FBD4E06FE96533A0489F09D8AD7FEA2F738EC8DD8B39E7766E5891003C52E2C0C9D788BE3EF841FFB6D9AC2D75648B147E8BD8641BF8937D6ACA73FA74BC19679B60D281B149987075F4E05127B03345A8FB0BEB57ACA3AD998AB638A3147D562FF25C874A05D221CFED8A78701C45A8454FFD20592DE891424837BEF2B47540B8E91C7FE6403C9ADEA06F1FB1CB4120A8D3D826ADDBD55C10D8D65133B8207045520B69433A67FDF6BCC8B77D2C45C2D1DE2DE5C5E4CA2D5D2D894809F570B69A8FC8495E9E6F001398E55D07F2C5B9CCCBFE8E12AB4882B24E042EB83080EFEFAB4A0DB9C409EFE0709C8C2F3679A2460471F24B224CF5CB64775151C75D6D86D68DBDC495D02F568362BD9199B16039F3EB8DE795C0DF1ACBB97F7E5683B9BCCD050646E3D3C1CC289AE3007505C45618AF983EB0AEC6F1E924E4626B546BED3066DC2A32C7D012496AE1ECA8E5AA047D62BBAFD6E8523D29B17C9C0465E848F7844C9C8937A00E1EA9A6666CEE57E6D2BEDB940EE553743516F7C995DE6EC447996D2FEA4153AE61A93A09B42B656C65B6BCA26E31DCCDD9C11DECD2EB6D21E1EB3559F687198683A224FBCC8E62C505E83ADC5F3BD5CF2F928FBEF6037BF5BE5F9F28EDD3793AA81FD4F55F929BFF969CFD1F44B12166A01C0000";
  byte[] bytes = Enumerable.Range(0, hex.Length).Where(x => x % 2 == 0).Select(x => Convert.ToByte(hex.Substring(x, 2), 16)).ToArray();
  byte[] decompressed = GZip.Decompress(bytes);
  string decomp = Encoding.UTF8.GetString(decompressed);
```

&nbsp; **9) alterando o protocolo de segurança de TLS para SSL no Visual Studio (para testes de envio de requisições https):**
&nbsp; a) criar método dummy abaixo dentro da mesma classe
 

```
public static bool RemoteCertificateValidationCB(Object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)
{
     return true;
}
```


b) adicionar as duas linhas abaixo logo antes do código que realiza a conexão https:
 

```
ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;
ServicePointManager.ServerCertificateValidationCallback = RemoteCertificateValidationCB;
```


**10) gerando lista de todas as aplicações no IIS:**
&nbsp; - Abrir um console "IIS Powershell"
&nbsp; - Se não estiver o "IIS Powershell" instalado, pode usar o prompt do DOS, e digitar os comandos abaixo:

```
C:\> Powershell 
PS C:\> Import-Module WebAdministration
```


   - No Powershell, executar o comando abaixo (trocando o path por algum caminho válido e com permissão de escrita, ou mesmo removendo para imprimir na tela)

```
dir IIS:\Sites | ForEach-Object {
    Get-WebApplication -Site $_.Name
}>>D:\temp\resultado.txt
```
