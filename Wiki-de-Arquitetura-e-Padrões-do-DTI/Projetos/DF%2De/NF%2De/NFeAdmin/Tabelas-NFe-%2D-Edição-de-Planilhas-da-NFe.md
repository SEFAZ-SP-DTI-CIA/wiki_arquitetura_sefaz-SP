# ​​Tabelas NFe 

A funcionalidade de TabelaNFe tem como objetivo a manipulação (edição) de planilhas encontradas no portal.

Para sua utilização, deverá ser acessado pelo menu Configurações -> Tabelas NFe:

​

![TabelasNFe_18inc.png](/.attachments/TabelasNFe_18inc-a0aa80d4-a11d-4d55-a597-d96663de77d6.png)

A tela contém todas as planilhas cadastradas onde podemos verificar:

A) Nome da tabela

B) Tipo da tabela (os tipos devem ser referente as planilhas do portal).​

C) Data (a data de inclusão da planilha).

D) Versão Ativa (a versão em uso).​​

![TabelasNFe_02.png](/.attachments/TabelasNFe_02-9fa4e263-5e0f-45eb-ac04-5359ea15137e.png)

## Funcionalidade de Edição da tabela

Para edição da tabela (planilha), deve-se clicar na linha referente à mesma no GridView. A tela de edição da tabela será exibida:

A tela possui duas abas. A seguir seguem as funcionalidades das abas:

## Aba de Informações Gerais

Aba **Informações Gerais**, contém dados gerais da tabela guardada:

![TabelasNFe_04.png](/.attachments/TabelasNFe_04-be47051c-fec0-4cf8-8de2-907d3a8ba7e3.png)

**Campo Nome da tabela:** deverá ser incluído o no nome da tabela ao gosto do usuário.

**Botão Ativar:** quando pressionado, torna a planilha em questão a única versão ativa na planilha inativando as outras.

**Campo Arquivo para upload:** utilizado para se fazer upload pela planilha escolhida pelo usuário.

**Campo Tipo da planilha:** contém uma lista com todos os tipos de planilha encontrados no portal.

**Campo Campos da planilha:** deve conter a mesma  quantidade de colunas que a planilha a qual está sendo feito o upload. Caso possua uma quantidade maior ou menor, apresentará critica ao salva-la.

**Campo Tipo do campo:** deve-se selecionar um item da lista (Texto, Inteiro ou Data) que representará o tipo do campo inserido na planilha.

**Botão Incluir campo:** quando clicado adicionará no **Campos da planilha** o tipo inserido separado por ";".

**Botão Salvar:** salva todas as informações que foram alteradas na aba Informações Gerais.

 

## Aba de Dados da Planilha

Dados da Planilha – Contém a planilha em si com dados que podem ser editados (incluir, alterar e excluir). 



![TabelasNFe_06.png](/.attachments/TabelasNFe_06-1e910aa8-14b1-4a07-9474-6993d527a1cb.png)

A seguir será explanado uma descrição de cada funcionalidade:

## Incluir linha na planilha

No rodapé do grid o usuário encontrará campos a serem preenchidos e ao clicar em adicionar, será incluído um registro em tempo de execução na planilha.

![TabelasNFe_01inc.png](/.attachments/TabelasNFe_01inc-40e33512-9db5-49e6-8a70-083f48b81344.png)

![TabelasNFe_02inc.png](/.attachments/TabelasNFe_02inc-6cf8ba15-9cd3-428f-a27f-243cff57c01b.png)

![TabelasNFe_03inc.png](/.attachments/TabelasNFe_03inc-37328a5b-3d9e-4af9-891d-ebc6fcd42860.png)

**Nota:** o item incluído sempre será o ultimo da planilha.​



## Alterar linha na planilha

Para editar a linha da planilha, deve-se clicar em **Editar** no canto direito do registro.

![TabelasNFe_04inc.png](/.attachments/TabelasNFe_04inc-cb583aca-bd1c-42a4-a5da-3ae8fbc9adc0.png)

Será aberto campos para a edição do item e surgirão no lugar do botão os Botões Atualizar e Cancelar:

![TabelasNFe_05inc.png](/.attachments/TabelasNFe_05inc-9bf3db27-eecb-4dd5-87d8-de2448cce331.png)

Caso se clique em cancelar a linha da planilha retornará ao formato original caso ao contrário a atualização ocorrerá normalmente:

![TabelasNFe_06inc.png](/.attachments/TabelasNFe_06inc-ca8b96e7-1594-4e52-8899-70b9369867e9.png)

![TabelasNFe_07inc.png](/.attachments/TabelasNFe_07inc-8b2de023-d547-43cd-befe-f38ab43327ad.png)

## Excluir linha na planilha

Para excluir a linha da planilha, deve-se clicar em **Excluir** no canto direito do registro.

O campo será automaticamente excluído:



![TabelasNFe_08inc.png](/.attachments/TabelasNFe_08inc-0a502734-ad4a-497d-9af5-e8c3d68a8269.png)

_Figura 01 - Item antes da exclusão​_

![TabelasNFe_09inc.png](/.attachments/TabelasNFe_09inc-61c37f66-7779-4f5e-83ea-d5a88728dab8.png)

_Figura 02 - Item depois da exclusão​_

Nota: Cada inclusão, edição e exclusão e feita em tempo de execução sendo salva automaticamente. Essa alteração pode ser desfeita na funcionalidade Log de alterações que pode ser encontra na própria Tabelas NFe:​

![TabelasNFe_10inc.png](/.attachments/TabelasNFe_10inc-62f24858-2797-4099-937a-e17c30d1a5b3.png)

Ou acessando o menu Usuários -> Log de Alterações Planilha NFe.



## Funcionalidade de Inserir da tabela

 

Para incluir uma nova tabela (planilha), deve-se clicar no botão Inserir:

![TabelasNFe_11inc.png](/.attachments/TabelasNFe_11inc-04f9880d-1cec-4718-ac0d-345988e3f02e.png)

Será aberta uma tela semelhante a tela de edição da planilha, porém, com os campos em branco para inclusão de registros:

![TabelasNFe_12inc.png](/.attachments/TabelasNFe_12inc-fbe4446c-514c-46c2-a5aa-810d1e30c4bd.png)

![TabelasNFe_13inc.png](/.attachments/TabelasNFe_13inc-88a7f76f-a7b9-45a2-84cc-7f56bbe53551.png)

Para a inclusão da planilha o usuário deverá preencher todos os campos encontrados na aba **Informações Gerais** (isso inclui efetuar o upload da planilha localizado no campo arquivo para upload) e clicar no botão Salvar.

Após o salvamento a tela carregará os dados, tornando possível edita-los.

## Funcionalidade de Excluir tabela

É possível excluir tabelas que não estão ativos clicando no botão **Excluir** no canto esquerdo do registro.

![TabelasNFe_14inc.png](/.attachments/TabelasNFe_14inc-765f81b8-9351-4b45-89c9-4e5933b1c7ee.png)

## Restaurar versão

Com a função **Log de alterações**, o usuário pode consultar todas as alterações feitas nas linhas da planilha editada e também pode restaurar a planilha até o ponto que foi feita a alteração na linha da mesma.

Para acessar a função de **Log de alterações**, o usuário pode seguir os seguintes passos:

01 - Pelo menu **Usuários -> Log de Alterações Planilha NFe**

![TabelasNFe_15inc.png](/.attachments/TabelasNFe_15inc-7279d202-d6fe-4523-8e8e-5a807a287542.png)

02 – Pela tela Tabela NFe

![TabelasNFe_16inc.png](/.attachments/TabelasNFe_16inc-0ec46209-817d-4afe-a9a3-fab67e449349.png)

Para Restaurar a versão especifica antes da alteração deve-se clicar no botão Voltar para essa versão.